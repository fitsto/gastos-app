<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title>
      <div class="welcome-header">
        <h1>¡Bienvenido, {{ userName }}! <ion-icon name="hand-left-outline"></ion-icon></h1>
      </div>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button class="action-button" routerLink="/add-expense">
        <ion-icon name="add-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="ion-padding main-content">
    <!-- Estado vacío -->
    <div class="empty-state" *ngIf="expenses.length === 0">
      <h1>¡Bienvenido, Felipe!</h1>
      <ion-icon name="wallet-outline" class="empty-icon"></ion-icon>
      <p>Comienza agregando tu primer gasto.</p>

      <div class="empty-actions">
        <ion-button expand="block" routerLink="/add-expense" class="primary-action">
          Agregar primer gasto
        </ion-button>
        <ion-button expand="block" fill="outline" routerLink="/categories">
          Configurar categorías
        </ion-button>
      </div>
    </div>

    <!-- Contenido cuando hay gastos -->
    <ng-container *ngIf="expenses.length > 0">
      <!-- Total del mes -->
      <div class="amount-card">
        <h2 class="amount-title">$ {{ total | number:'1.0-0' }}</h2>
        <p class="amount-subtitle">Total gastado este mes</p>
      </div>

      <!-- Gráfico de categorías -->
      <div class="chart-container">
        <canvas #expensesChart></canvas>
      </div>

      <!-- Progreso del presupuesto -->
      <div class="budget-progress">
        <h3>Progreso Presupuesto</h3>
        <div class="progress-bars">
          <div class="progress-item" *ngFor="let category of categoryProgress">
            <div class="progress-header">
              <span class="category-name">{{ category.name }}</span>
              <span class="progress-percentage">{{ category.percentage }}%</span>
            </div>
            <ion-progress-bar [value]="category.percentage / 100" [color]="category.color"></ion-progress-bar>
          </div>
        </div>
      </div>

      <!-- Botones de acción -->
      <div class="action-buttons">
        <ion-button expand="block" fill="outline" routerLink="/history">
          <ion-icon name="time-outline" slot="start"></ion-icon>
          Ver historial de gastos
        </ion-button>
        <ion-button expand="block" fill="outline" routerLink="/categories">
          <ion-icon name="list-outline" slot="start"></ion-icon>
          Administrar categorías
        </ion-button>
      </div>
    </ng-container>
  </div>

  <!-- Botón flotante para agregar gasto (solo se muestra cuando ya hay gastos) -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" *ngIf="expenses.length > 0">
    <ion-fab-button routerLink="/add-expense">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
